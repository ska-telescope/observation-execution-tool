<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="513px" preserveAspectRatio="none" style="width:1132px;height:513px;" version="1.1" viewBox="0 0 1132 513" width="1132px" zoomAndPan="magnify"><defs><filter height="300%" id="f3wkgs4fp786y" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[acbe3f2f009d37df68d618890c3db7e1]
class TangoExecutor--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="163.2422" id="TangoExecutor" style="stroke: #A80036; stroke-width: 1.5;" width="308" x="374.5" y="8"/><ellipse cx="477.25" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M480.2188,29.6406 Q479.6406,29.9375 479,30.0781 Q478.3594,30.2344 477.6563,30.2344 Q475.1563,30.2344 473.8281,28.5938 Q472.5156,26.9375 472.5156,23.8125 Q472.5156,20.6875 473.8281,19.0313 Q475.1563,17.375 477.6563,17.375 Q478.3594,17.375 479,17.5313 Q479.6563,17.6875 480.2188,17.9844 L480.2188,20.7031 Q479.5938,20.125 479,19.8594 Q478.4063,19.5781 477.7813,19.5781 Q476.4375,19.5781 475.75,20.6563 Q475.0625,21.7188 475.0625,23.8125 Q475.0625,25.9063 475.75,26.9844 Q476.4375,28.0469 477.7813,28.0469 Q478.4063,28.0469 479,27.7813 Q479.5938,27.5 480.2188,26.9219 L480.2188,29.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="497.75" y="28.1543">TangoExecutor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="375.5" x2="681.5" y1="40" y2="40"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="380.5" y="54.2104">_proxy_factory: ProxyFactory</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="380.5" y="67.0151">_device_proxies: Dict[str, DeviceProxy]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="380.5" y="79.8198">queue: Queue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="375.5" x2="681.5" y1="86.4141" y2="86.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="203" x="380.5" y="100.6245">execute(cmd: Command, **kwargs)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="380.5" y="113.4292">read(attribute: Attribute)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="384.5" y="126.2339"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="240" x="380.5" y="139.0386">subscribe_event(attribute: Attribute) -&gt; int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="296" x="380.5" y="151.8433">unsubscribe_event(attribute: Attribute, event_id: int)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="380.5" y="164.6479">read_event(attr: Attribute) -&gt; tango.EventData</text><!--MD5=[9614ebc5940adeaf817927e017fe9246]
class EventHandlingStrategy--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="86.4141" id="EventHandlingStrategy" style="stroke: #A80036; stroke-width: 1.5;" width="308" x="323.5" y="237.5"/><ellipse cx="401.75" cy="253.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M404.7188,259.1406 Q404.1406,259.4375 403.5,259.5781 Q402.8594,259.7344 402.1563,259.7344 Q399.6563,259.7344 398.3281,258.0938 Q397.0156,256.4375 397.0156,253.3125 Q397.0156,250.1875 398.3281,248.5313 Q399.6563,246.875 402.1563,246.875 Q402.8594,246.875 403.5,247.0313 Q404.1563,247.1875 404.7188,247.4844 L404.7188,250.2031 Q404.0938,249.625 403.5,249.3594 Q402.9063,249.0781 402.2813,249.0781 Q400.9375,249.0781 400.25,250.1563 Q399.5625,251.2188 399.5625,253.3125 Q399.5625,255.4063 400.25,256.4844 Q400.9375,257.5469 402.2813,257.5469 Q402.9063,257.5469 403.5,257.2813 Q404.0938,257 404.7188,256.4219 L404.7188,259.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="143" x="422.25" y="257.6543">EventHandlingStrategy</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="324.5" x2="630.5" y1="269.5" y2="269.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="324.5" x2="630.5" y1="277.5" y2="277.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="240" x="329.5" y="291.7104">subscribe_event(attribute: Attribute) -&gt; int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="296" x="329.5" y="304.5151">unsubscribe_event(attribute: Attribute, event_id: int)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="329.5" y="317.3198">read_event(attr: Attribute) -&gt; tango.EventData</text><path d="M6,54 L6,124.5313 A0,0 0 0 0 6,124.5313 L225.5104,124.5313 L408.7554,237.4501 L233.5104,124.5313 L339,124.5313 A0,0 0 0 0 339,124.5313 L339,64 L329,54 L6,54 A0,0 0 0 0 6,54 " fill="#FBFB77" filter="url(#f3wkgs4fp786y)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M329,54 L329,64 L339,64 L329,54 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="12" y="71.0669">This protocol is implied rather than implemented</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="12" y="86.1997">at this stage to avoid overcomplicating the code.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="300" x="12" y="101.3325">The code just has a SingleQueueEventStrategy</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="12" y="116.4653">directly.</text><!--MD5=[48dac5f4530949a84a25564d242fd018]
class SingleQueueEventStrategy--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="48" id="SingleQueueEventStrategy" style="stroke: #A80036; stroke-width: 1.5;" width="199" x="718" y="65.5"/><ellipse cx="733" cy="81.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M735.9688,87.1406 Q735.3906,87.4375 734.75,87.5781 Q734.1094,87.7344 733.4063,87.7344 Q730.9063,87.7344 729.5781,86.0938 Q728.2656,84.4375 728.2656,81.3125 Q728.2656,78.1875 729.5781,76.5313 Q730.9063,74.875 733.4063,74.875 Q734.1094,74.875 734.75,75.0313 Q735.4063,75.1875 735.9688,75.4844 L735.9688,78.2031 Q735.3438,77.625 734.75,77.3594 Q734.1563,77.0781 733.5313,77.0781 Q732.1875,77.0781 731.5,78.1563 Q730.8125,79.2188 730.8125,81.3125 Q730.8125,83.4063 731.5,84.4844 Q732.1875,85.5469 733.5313,85.5469 Q734.1563,85.5469 734.75,85.2813 Q735.3438,85 735.9688,84.4219 L735.9688,87.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="167" x="747" y="85.6543">SingleQueueEventStrategy</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="719" x2="916" y1="97.5" y2="97.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="719" x2="916" y1="105.5" y2="105.5"/><!--MD5=[d40932010816485ec57b44b6eea2392a]
class Observer--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="60.8047" id="Observer" style="stroke: #A80036; stroke-width: 1.5;" width="169" x="952" y="59"/><ellipse cx="1004.25" cy="75" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1007.2188,80.6406 Q1006.6406,80.9375 1006,81.0781 Q1005.3594,81.2344 1004.6563,81.2344 Q1002.1563,81.2344 1000.8281,79.5938 Q999.5156,77.9375 999.5156,74.8125 Q999.5156,71.6875 1000.8281,70.0313 Q1002.1563,68.375 1004.6563,68.375 Q1005.3594,68.375 1006,68.5313 Q1006.6563,68.6875 1007.2188,68.9844 L1007.2188,71.7031 Q1006.5938,71.125 1006,70.8594 Q1005.4063,70.5781 1004.7813,70.5781 Q1003.4375,70.5781 1002.75,71.6563 Q1002.0625,72.7188 1002.0625,74.8125 Q1002.0625,76.9063 1002.75,77.9844 Q1003.4375,79.0469 1004.7813,79.0469 Q1005.4063,79.0469 1006,78.7813 Q1006.5938,78.5 1007.2188,77.9219 L1007.2188,80.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="1024.75" y="79.1543">Observer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="953" x2="1120" y1="91" y2="91"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="953" x2="1120" y1="99" y2="99"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="958" y="113.2104">notify(evt: tango.EventData)</text><!--MD5=[b832a341cdf0ee643d00e35a84d93f87]
class SubscriptionManager--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="99.2188" id="SubscriptionManager" style="stroke: #A80036; stroke-width: 1.5;" width="302" x="666.5" y="231"/><ellipse cx="746.75" cy="247" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M749.7188,252.6406 Q749.1406,252.9375 748.5,253.0781 Q747.8594,253.2344 747.1563,253.2344 Q744.6563,253.2344 743.3281,251.5938 Q742.0156,249.9375 742.0156,246.8125 Q742.0156,243.6875 743.3281,242.0313 Q744.6563,240.375 747.1563,240.375 Q747.8594,240.375 748.5,240.5313 Q749.1563,240.6875 749.7188,240.9844 L749.7188,243.7031 Q749.0938,243.125 748.5,242.8594 Q747.9063,242.5781 747.2813,242.5781 Q745.9375,242.5781 745.25,243.6563 Q744.5625,244.7188 744.5625,246.8125 Q744.5625,248.9063 745.25,249.9844 Q745.9375,251.0469 747.2813,251.0469 Q747.9063,251.0469 748.5,250.7813 Q749.0938,250.5 749.7188,249.9219 L749.7188,252.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="133" x="767.25" y="251.1543">SubscriptionManager</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="667.5" x2="967.5" y1="263" y2="263"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="672.5" y="277.2104">_proxy_factory: ProxyFactory</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="672.5" y="290.0151">_subscriptions: Dict[Attribute, Callback]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="667.5" x2="967.5" y1="296.6094" y2="296.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="276" x="672.5" y="310.8198">register_observer(attr: Attribute, obs: Observer)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="290" x="672.5" y="323.6245">unregister_observer(attr: Attribute, obs: Observer)</text><!--MD5=[687e0e93109a4e3b835e34cee365dc7c]
class Callback--><rect fill="#FEFECE" filter="url(#f3wkgs4fp786y)" height="112.0234" id="Callback" style="stroke: #A80036; stroke-width: 1.5;" width="248" x="693.5" y="390"/><ellipse cx="787.25" cy="406" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M790.2188,411.6406 Q789.6406,411.9375 789,412.0781 Q788.3594,412.2344 787.6563,412.2344 Q785.1563,412.2344 783.8281,410.5938 Q782.5156,408.9375 782.5156,405.8125 Q782.5156,402.6875 783.8281,401.0313 Q785.1563,399.375 787.6563,399.375 Q788.3594,399.375 789,399.5313 Q789.6563,399.6875 790.2188,399.9844 L790.2188,402.7031 Q789.5938,402.125 789,401.8594 Q788.4063,401.5781 787.7813,401.5781 Q786.4375,401.5781 785.75,402.6563 Q785.0625,403.7188 785.0625,405.8125 Q785.0625,407.9063 785.75,408.9844 Q786.4375,410.0469 787.7813,410.0469 Q788.4063,410.0469 789,409.7813 Q789.5938,409.5 790.2188,408.9219 L790.2188,411.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="807.75" y="410.1543">Callback</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="694.5" x2="940.5" y1="422" y2="422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="230" x="699.5" y="436.2104">_observers: weakref.WeakSet[Observer]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="694.5" x2="940.5" y1="442.8047" y2="442.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="699.5" y="457.0151">register_observer(observer: Observer)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="236" x="699.5" y="469.8198">unregister_observer(observer: Observer)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="185" x="699.5" y="482.6245">notify_observers(evt: EventData)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="699.5" y="495.4292">__call__(evt: tango.EventData)</text><!--MD5=[2bd5d106b08300fb9fed019160cc29fa]
link SingleQueueEventStrategy to EventHandlingStrategy--><path d="M785.5948,113.6996 C762.5514,130.682 730.3593,153.407 700.5,171 C665.9286,191.3694 627.0333,211.3952 591.5227,228.6371 " fill="none" id="SingleQueueEventStrategy-&gt;EventHandlingStrategy" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="594.3615,235.0391,573.3023,237.3868,588.301,222.4188,594.3615,235.0391" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[997791cf8eb88e7f066eb2b6dde32420]
link SingleQueueEventStrategy to Observer--><path d="M917.1621,89.5 C921.9233,89.5 926.6845,89.5 931.4457,89.5 " fill="none" id="SingleQueueEventStrategy-&gt;Observer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="931.6583,82.4999,951.6582,89.5,931.6582,96.4999,931.6583,82.4999" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[f8da1e7ca350de248c19a7be4427da7a]
reverse link SingleQueueEventStrategy to SubscriptionManager--><path d="M817.5,126.7951 C817.5,156.4773 817.5,198.2862 817.5,230.8078 " fill="none" id="SingleQueueEventStrategy&lt;-SubscriptionManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="817.5,113.6903,813.5,119.6903,817.5,125.6903,821.5,119.6903,817.5,113.6903" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[025f16e540ea438561caf93b3265616f]
reverse link TangoExecutor to EventHandlingStrategy--><path d="M503.3479,183.697 C498.3273,202.4998 493.2887,221.3699 489.0107,237.3912 " fill="none" id="TangoExecutor&lt;-EventHandlingStrategy" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="506.7235,171.0552,501.311,175.8202,503.6278,182.649,509.0402,177.884,506.7235,171.0552" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[945b3beb3ee22e233dd8d1dfb8e339bb]
reverse link TangoExecutor to SubscriptionManager--><path d="M662.786,178.2496 C690.2101,196.3741 718.1272,214.8246 742.5599,230.9721 " fill="none" id="TangoExecutor&lt;-SubscriptionManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="651.9003,171.0552,654.7004,177.7005,661.9114,177.6717,659.1113,171.0264,651.9003,171.0552" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[719dd0474a15560b8cc277c96025c905]
reverse link SubscriptionManager to Callback--><path d="M817.5,343.266 C817.5,358.532 817.5,374.7631 817.5,389.7076 " fill="none" id="SubscriptionManager&lt;-Callback" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="817.5,330.1555,813.5,336.1555,817.5,342.1555,821.5,336.1555,817.5,330.1555" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[8d995da3e840fab60b290c371f80110a]
@startuml

class TangoExecutor {
_proxy_factory: ProxyFactory
_device_proxies: Dict[str, DeviceProxy]
queue: Queue
execute(cmd: Command, **kwargs)
read(attribute: Attribute)

subscribe_event(attribute: Attribute) -> int
unsubscribe_event(attribute: Attribute, event_id: int)
read_event(attr: Attribute) -> tango.EventData
}

class EventHandlingStrategy {
subscribe_event(attribute: Attribute) -> int
unsubscribe_event(attribute: Attribute, event_id: int)
read_event(attr: Attribute) -> tango.EventData
}
note top of EventHandlingStrategy
This protocol is implied rather than implemented
at this stage to avoid overcomplicating the code.
The code just has a SingleQueueEventStrategy
directly.
end note

class SingleQueueEventStrategy {
}
SingleQueueEventStrategy -|> EventHandlingStrategy
SingleQueueEventStrategy -|> Observer
SingleQueueEventStrategy *- - SubscriptionManager

class Observer {
notify(evt: tango.EventData)
}

class SubscriptionManager {
_proxy_factory: ProxyFactory
_subscriptions: Dict[Attribute, Callback]
register_observer(attr: Attribute, obs: Observer)
unregister_observer(attr: Attribute, obs: Observer)
}


class Callback {
_observers: weakref.WeakSet[Observer]
register_observer(observer: Observer)
unregister_observer(observer: Observer)
notify_observers(evt: EventData)
__call__(evt: tango.EventData)
}

TangoExecutor *- - EventHandlingStrategy
TangoExecutor *- - SubscriptionManager
SubscriptionManager *- - Callback

@enduml

PlantUML version 1.2020.06(Sun Apr 05 12:38:32 GMT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14-ea+33
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
