<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="766px" preserveAspectRatio="none" style="width:1699px;height:766px;" version="1.1" viewBox="0 0 1699 766" width="1699px" zoomAndPan="magnify"><defs><filter height="300%" id="f10hpu080zq3mo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f10hpu080zq3mo)" height="752.1406" style="stroke: #000000; stroke-width: 1.0;" width="1680" x="8" y="3"/><path d="M191,4 L191,12.2969 L181,22.2969 L8,22.2969 " fill="none" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="11" y="16.9951">Activity API over REST</text><rect fill="#FFFFFF" filter="url(#f10hpu080zq3mo)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="256" x="721.5" y="243.5547"/><rect fill="#FFFFFF" filter="url(#f10hpu080zq3mo)" height="162.7969" style="stroke: #000000; stroke-width: 2.0;" width="1199.5" x="482.5" y="520.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="64" x2="64" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="347" x2="347" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="606.5" x2="606.5" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="846.5" x2="846.5" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1066.5" x2="1066.5" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1284.5" x2="1284.5" y1="80.8906" y2="700.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1584" x2="1584" y1="80.8906" y2="700.5469"/><rect fill="#90EE90" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="13" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="47.5" y="49.292">CLI :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="20" y="65.5889">RestClientUI</text><rect fill="#90EE90" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="13" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="47.5" y="719.542">CLI :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="20" y="735.8389">RestClientUI</text><rect fill="#ADD8E6" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="283" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="290" y="49.292">REST backend :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="303" y="65.5889">FlaskWorker</text><rect fill="#ADD8E6" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="283" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="290" y="719.542">REST backend :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="303" y="735.8389">FlaskWorker</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="492.5" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="562" y="49.292">SBAWorker:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="211" x="499.5" y="65.5889">ScheduingBlockAcitivityWorker</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="492.5" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="562" y="719.542">SBAWorker:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="211" x="499.5" y="735.8389">ScheduingBlockAcitivityWorker</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="226" x="731.5" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="782" y="49.292">SBActivityService:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="212" x="738.5" y="65.5889">ScheduingBlockAcitivityService</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="226" x="731.5" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="782" y="719.542">SBActivityService:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="212" x="738.5" y="735.8389">ScheduingBlockAcitivityService</text><rect fill="#ADD8E6" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="971.5" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1045" y="49.292">ODA :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="978.5" y="65.5889">Observation Data Archive</text><rect fill="#ADD8E6" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="971.5" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1045" y="719.542">ODA :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="978.5" y="735.8389">Observation Data Archive</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="220" x="1172.5" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1240" y="49.292">SESWorker :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="206" x="1179.5" y="65.5889">ScriptExecutionServiceWorker</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="220" x="1172.5" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1240" y="719.542">SESWorker :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="206" x="1179.5" y="735.8389">ScriptExecutionServiceWorker</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="1497" y="29.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1510" y="49.292">Script Execution API :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="1504" y="65.5889">ScriptExecutionService</text><rect fill="#FEFECE" filter="url(#f10hpu080zq3mo)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="1497" y="699.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1510" y="719.542">Script Execution API :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="1504" y="735.8389">ScriptExecutionService</text><polygon fill="#A80036" points="335,108.0234,345,112.0234,335,116.0234,339,112.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="341" y1="112.0234" y2="112.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="71" y="106.9575">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="84" y="106.9575">HTTP POST to /api/v1/activities</text><polygon fill="#A80036" points="595,137.1563,605,141.1563,595,145.1563,599,141.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="347" x2="601" y1="141.1563" y2="141.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="354" y="136.0903">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="367" y="136.0903">send message request.activity.run</text><polygon fill="#A80036" points="834.5,166.2891,844.5,170.2891,834.5,174.2891,838.5,170.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="607" x2="840.5" y1="170.2891" y2="170.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="614" y="165.2231">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="627" y="165.2231">run(cmd: ActivityCommand)</text><polygon fill="#A80036" points="1055,195.4219,1065,199.4219,1055,203.4219,1059,199.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846.5" x2="1061" y1="199.4219" y2="199.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="853.5" y="194.356">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="866.5" y="194.356">get_sbd(sbd_id)</text><polygon fill="#A80036" points="857.5,224.5547,847.5,228.5547,857.5,232.5547,853.5,228.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="851.5" x2="1066" y1="228.5547" y2="228.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="863.5" y="223.4888">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="876.5" y="223.4888">pdm.SchedulingBlock</text><path d="M721.5,243.5547 L791.5,243.5547 L791.5,250.5547 L781.5,260.5547 L721.5,260.5547 L721.5,243.5547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="256" x="721.5" y="243.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="736.5" y="256.6216">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="806.5" y="255.7651">[arg_override provided]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="846.5" x2="888.5" y1="281.8203" y2="281.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="888.5" x2="888.5" y1="281.8203" y2="294.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="847.5" x2="888.5" y1="294.8203" y2="294.8203"/><polygon fill="#A80036" points="857.5,290.8203,847.5,294.8203,857.5,298.8203,853.5,294.8203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="853.5" y="276.7544">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="866.5" y="276.7544">update SB args</text><polygon fill="#A80036" points="1272.5,326.9531,1282.5,330.9531,1272.5,334.9531,1276.5,330.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846.5" x2="1278.5" y1="330.9531" y2="330.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="853.5" y="325.8872">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="866.5" y="325.8872">message request.procedure.prepare</text><polygon fill="#A80036" points="1572.5,356.0859,1582.5,360.0859,1572.5,364.0859,1576.5,360.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1284.5" x2="1578.5" y1="360.0859" y2="360.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1291.5" y="355.02">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="263" x="1304.5" y="355.02">prepare(cmd: PrepareProcessCommand)</text><polygon fill="#A80036" points="1295.5,385.2188,1285.5,389.2188,1295.5,393.2188,1291.5,389.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1289.5" x2="1583.5" y1="389.2188" y2="389.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1301.5" y="384.1528">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1314.5" y="384.1528">ProcedureSummary</text><polygon fill="#A80036" points="857.5,414.3516,847.5,418.3516,857.5,422.3516,853.5,418.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="851.5" x2="1283.5" y1="418.3516" y2="418.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="863.5" y="413.2856">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="885.5" y="413.2856">message procedure.lifecycle.preparing</text><polygon fill="#A80036" points="618,443.4844,608,447.4844,618,451.4844,614,447.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="612" x2="845.5" y1="447.4844" y2="447.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="624" y="442.4185">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="646" y="442.4185">ProcedureSummary</text><polygon fill="#A80036" points="358,472.6172,348,476.6172,358,480.6172,354,476.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352" x2="606" y1="476.6172" y2="476.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="364" y="471.5513">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="386" y="471.5513">message activity.lifecycle.running</text><polygon fill="#A80036" points="75,501.75,65,505.75,75,509.75,71,505.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="346" y1="505.75" y2="505.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="81" y="500.6841">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="103" y="500.6841">HTTP OK + ProcedureSummary JSON</text><path d="M482.5,520.75 L552.5,520.75 L552.5,527.75 L542.5,537.75 L482.5,537.75 L482.5,520.75 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="162.7969" style="stroke: #000000; stroke-width: 2.0;" width="1199.5" x="482.5" y="520.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="497.5" y="533.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="567.5" y="532.9604">[prepare_only not set]</text><polygon fill="#A80036" points="1272.5,555.0156,1282.5,559.0156,1272.5,563.0156,1276.5,559.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846.5" x2="1278.5" y1="559.0156" y2="559.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="853.5" y="553.9497">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="298" x="875.5" y="553.9497">message request.procedure.start (force=true)</text><polygon fill="#A80036" points="1572.5,584.1484,1582.5,588.1484,1572.5,592.1484,1576.5,588.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1284.5" x2="1578.5" y1="588.1484" y2="588.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1291.5" y="583.0825">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="1313.5" y="583.0825">start(cmd: StartProcessCommand)</text><polygon fill="#A80036" points="1295.5,613.2813,1285.5,617.2813,1295.5,621.2813,1291.5,617.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1289.5" x2="1583.5" y1="617.2813" y2="617.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1301.5" y="612.2153">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1323.5" y="612.2153">ProcedureSummary</text><polygon fill="#A80036" points="857.5,642.4141,847.5,646.4141,857.5,650.4141,853.5,646.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="851.5" x2="1283.5" y1="646.4141" y2="646.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="863.5" y="641.3481">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="885.5" y="641.3481">message procedure.lifecycle.started</text><polygon fill="#A80036" points="618,671.5469,608,675.5469,618,679.5469,614,675.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="612" x2="845.5" y1="675.5469" y2="675.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="624" y="670.481">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="646" y="670.481">ProcedureSummary</text><!--MD5=[c26408166243d69139810b307039e980]
@startuml


mainframe **Activity API over REST**

autonumber

participant cli as "CLI :\nRestClientUI" #lightgreen
participant FlaskWorker as "REST backend :\nFlaskWorker" #lightblue
participant SBActivityWorker as "SBAWorker: \nScheduingBlockAcitivityWorker"
participant SBActivityService as "SBActivityService: \nScheduingBlockAcitivityService"
participant ODA as "ODA :\nObservation Data Archive" #lightblue
participant ScriptExecutionServiceWorker as "SESWorker :\nScriptExecutionServiceWorker"
participant ScriptExecutionService as "Script Execution API :\nScriptExecutionService"

cli -> FlaskWorker: HTTP POST to /api/v1/activities 

FlaskWorker -> SBActivityWorker: send message request.activity.run

SBActivityWorker -> SBActivityService: run(cmd: ActivityCommand)

SBActivityService -> ODA: get_sbd(sbd_id)
ODA -> SBActivityService: pdm.SchedulingBlock
opt arg_override provided
SBActivityService -> SBActivityService: update SB args
end

SBActivityService -> ScriptExecutionServiceWorker: message request.procedure.prepare

ScriptExecutionServiceWorker -> ScriptExecutionService: prepare(cmd: PrepareProcessCommand)

ScriptExecutionService -> ScriptExecutionServiceWorker: ProcedureSummary

ScriptExecutionServiceWorker -> SBActivityService: message procedure.lifecycle.preparing

SBActivityService -> SBActivityWorker: ProcedureSummary

SBActivityWorker -> FlaskWorker: message activity.lifecycle.running

cli <- FlaskWorker: HTTP OK + ProcedureSummary JSON

opt prepare_only not set
SBActivityService -> ScriptExecutionServiceWorker: message request.procedure.start (force=true)

ScriptExecutionServiceWorker -> ScriptExecutionService: start(cmd: StartProcessCommand)

ScriptExecutionService -> ScriptExecutionServiceWorker: ProcedureSummary

ScriptExecutionServiceWorker -> SBActivityService: message procedure.lifecycle.started

SBActivityService -> SBActivityWorker: ProcedureSummary

end

@enduml

PlantUML version 1.2020.06(Sun Apr 05 12:38:32 GMT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14-ea+33
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>