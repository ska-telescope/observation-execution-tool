<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="858px" preserveAspectRatio="none" style="width:1535px;height:858px;" version="1.1" viewBox="0 0 1535 858" width="1535px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dp17vfn6wl5k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[4caa97c3b43e5ccb768f5326915ee1d4]
cluster ska_oso_oet.procedure--><polygon fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" points="14,16,204,16,211,38.2969,1513,38.2969,1513,846,14,846,14,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="211" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="18" y="30.9951">ska_oso_oet.procedure</text><!--MD5=[e05846e0557a046bf7b9258196848ed8]
cluster application_pkg--><polygon fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" points="22,43,113,43,120,65.2969,1379,65.2969,1379,738,22,738,22,43" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="120" y1="65.2969" y2="65.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="26" y="57.9951">application</text><!--MD5=[a70b0d373322012744ecc119c63f921b]
cluster main--><rect fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" height="242" style="stroke: #000000; stroke-width: 1.5;" width="279" x="656" y="70"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="777" y="84.9951">main</text><!--MD5=[01b908eab77bdc64a587d21ad331408b]
cluster restserver--><rect fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" height="264.5" style="stroke: #000000; stroke-width: 1.5;" width="608" x="763" y="420.5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="1025" y="435.4951">restserver</text><!--MD5=[3ff016c1aa5003d713567a073e2181a6]
cluster application--><rect fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" height="332" style="stroke: #000000; stroke-width: 1.5;" width="725" x="30" y="398"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="350" y="412.9951">application</text><!--MD5=[71c2ab1c1c8272e025db689c64a870a2]
cluster flask--><polygon fill="#FFFFFF" filter="url(#f1dp17vfn6wl5k)" points="1390,602,1433,602,1440,624.2969,1505,624.2969,1505,838,1390,838,1390,602" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1390" x2="1440" y1="624.2969" y2="624.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="1394" y="616.9951">flask</text><!--MD5=[b57936688dd02f834049b5feb8e1c3e8]
class ActivityWorker--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="60.8047" id="ActivityWorker" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="664.5" y="243"/><ellipse cx="679.5" cy="259" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M682.4688,264.6406 Q681.8906,264.9375 681.25,265.0781 Q680.6094,265.2344 679.9063,265.2344 Q677.4063,265.2344 676.0781,263.5938 Q674.7656,261.9375 674.7656,258.8125 Q674.7656,255.6875 676.0781,254.0313 Q677.4063,252.375 679.9063,252.375 Q680.6094,252.375 681.25,252.5313 Q681.9063,252.6875 682.4688,252.9844 L682.4688,255.7031 Q681.8438,255.125 681.25,254.8594 Q680.6563,254.5781 680.0313,254.5781 Q678.6875,254.5781 678,255.6563 Q677.3125,256.7188 677.3125,258.8125 Q677.3125,260.9063 678,261.9844 Q678.6875,263.0469 680.0313,263.0469 Q680.6563,263.0469 681.25,262.7813 Q681.8438,262.5 682.4688,261.9219 L682.4688,264.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="693.5" y="263.1543">ActivityWorker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="665.5" x2="782.5" y1="275" y2="275"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="665.5" x2="782.5" y1="283" y2="283"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="670.5" y="297.2104">run(...)</text><!--MD5=[17238aaf72f47361d520c29dfe37cd7f]
class FlaskWorker--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="FlaskWorker" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="819" y="249.5"/><ellipse cx="834" cy="265.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M836.9688,271.1406 Q836.3906,271.4375 835.75,271.5781 Q835.1094,271.7344 834.4063,271.7344 Q831.9063,271.7344 830.5781,270.0938 Q829.2656,268.4375 829.2656,265.3125 Q829.2656,262.1875 830.5781,260.5313 Q831.9063,258.875 834.4063,258.875 Q835.1094,258.875 835.75,259.0313 Q836.4063,259.1875 836.9688,259.4844 L836.9688,262.2031 Q836.3438,261.625 835.75,261.3594 Q835.1563,261.0781 834.5313,261.0781 Q833.1875,261.0781 832.5,262.1563 Q831.8125,263.2188 831.8125,265.3125 Q831.8125,267.4063 832.5,268.4844 Q833.1875,269.5469 834.5313,269.5469 Q835.1563,269.5469 835.75,269.2813 Q836.3438,269 836.9688,268.4219 L836.9688,271.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="848" y="269.6543">FlaskWorker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="820" x2="926" y1="281.5" y2="281.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="820" x2="926" y1="289.5" y2="289.5"/><!--MD5=[182a5f28d356566e59ae05a80103f461]
class EventBusWorker--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="86.4141" id="EventBusWorker" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="711" y="97"/><ellipse cx="726" cy="113" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M728.9688,118.6406 Q728.3906,118.9375 727.75,119.0781 Q727.1094,119.2344 726.4063,119.2344 Q723.9063,119.2344 722.5781,117.5938 Q721.2656,115.9375 721.2656,112.8125 Q721.2656,109.6875 722.5781,108.0313 Q723.9063,106.375 726.4063,106.375 Q727.1094,106.375 727.75,106.5313 Q728.4063,106.6875 728.9688,106.9844 L728.9688,109.7031 Q728.3438,109.125 727.75,108.8594 Q727.1563,108.5781 726.5313,108.5781 Q725.1875,108.5781 724.5,109.6563 Q723.8125,110.7188 723.8125,112.8125 Q723.8125,114.9063 724.5,115.9844 Q725.1875,117.0469 726.5313,117.0469 Q727.1563,117.0469 727.75,116.7813 Q728.3438,116.5 728.9688,115.9219 L728.9688,118.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="102" x="740" y="117.1543">EventBusWorker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="712" x2="844" y1="129" y2="129"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="712" x2="844" y1="137" y2="137"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="717" y="151.2104">main_loop(...)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="717" y="164.0151">main_func(...)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="717" y="176.8198">republish(...)</text><!--MD5=[d26137e5d461602f48e26353ca7979f6]
class app--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="53.9375" id="app" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="875.5" y="447.5"/><ellipse cx="890.5" cy="466.4688" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M893.4688,472.1094 Q892.8906,472.4063 892.25,472.5469 Q891.6094,472.7031 890.9063,472.7031 Q888.4063,472.7031 887.0781,471.0625 Q885.7656,469.4063 885.7656,466.2813 Q885.7656,463.1563 887.0781,461.5 Q888.4063,459.8438 890.9063,459.8438 Q891.6094,459.8438 892.25,460 Q892.9063,460.1563 893.4688,460.4531 L893.4688,463.1719 Q892.8438,462.5938 892.25,462.3281 Q891.6563,462.0469 891.0313,462.0469 Q889.6875,462.0469 889,463.125 Q888.3125,464.1875 888.3125,466.2813 Q888.3125,468.375 889,469.4531 Q889.6875,470.5156 891.0313,470.5156 Q891.6563,470.5156 892.25,470.25 Q892.8438,469.9688 893.4688,469.3906 L893.4688,472.1094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="145" x="902.5" y="463.6387">«function return value»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="963" y="477.6074">app</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="876.5" x2="1047.5" y1="485.4375" y2="485.4375"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="876.5" x2="1047.5" y1="493.4375" y2="493.4375"/><!--MD5=[063f2cd66bd5ad9bd7f815e7793fa4a5]
class ProcedureAPIBlueprint--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="ProcedureAPIBlueprint" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="1191" y="629"/><ellipse cx="1206" cy="645" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1208.9688,650.6406 Q1208.3906,650.9375 1207.75,651.0781 Q1207.1094,651.2344 1206.4063,651.2344 Q1203.9063,651.2344 1202.5781,649.5938 Q1201.2656,647.9375 1201.2656,644.8125 Q1201.2656,641.6875 1202.5781,640.0313 Q1203.9063,638.375 1206.4063,638.375 Q1207.1094,638.375 1207.75,638.5313 Q1208.4063,638.6875 1208.9688,638.9844 L1208.9688,641.7031 Q1208.3438,641.125 1207.75,640.8594 Q1207.1563,640.5781 1206.5313,640.5781 Q1205.1875,640.5781 1204.5,641.6563 Q1203.8125,642.7188 1203.8125,644.8125 Q1203.8125,646.9063 1204.5,647.9844 Q1205.1875,649.0469 1206.5313,649.0469 Q1207.1563,649.0469 1207.75,648.7813 Q1208.3438,648.5 1208.9688,647.9219 L1208.9688,650.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="140" x="1220" y="649.1543">ProcedureAPIBlueprint</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1192" x2="1362" y1="661" y2="661"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1192" x2="1362" y1="669" y2="669"/><!--MD5=[6f0c4b922742566c5bef8de2a86e8f4b]
class ActivityAPIBlueprint--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="ActivityAPIBlueprint" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="771" y="629"/><ellipse cx="786" cy="645" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M788.9688,650.6406 Q788.3906,650.9375 787.75,651.0781 Q787.1094,651.2344 786.4063,651.2344 Q783.9063,651.2344 782.5781,649.5938 Q781.2656,647.9375 781.2656,644.8125 Q781.2656,641.6875 782.5781,640.0313 Q783.9063,638.375 786.4063,638.375 Q787.1094,638.375 787.75,638.5313 Q788.4063,638.6875 788.9688,638.9844 L788.9688,641.7031 Q788.3438,641.125 787.75,640.8594 Q787.1563,640.5781 786.5313,640.5781 Q785.1875,640.5781 784.5,641.6563 Q783.8125,642.7188 783.8125,644.8125 Q783.8125,646.9063 784.5,647.9844 Q785.1875,649.0469 786.5313,649.0469 Q787.1563,649.0469 787.75,648.7813 Q788.3438,648.5 788.9688,647.9219 L788.9688,650.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="800" y="649.1543">ActivityAPIBlueprint</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="772" x2="920" y1="661" y2="661"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="772" x2="920" y1="669" y2="669"/><!--MD5=[ac5fbc7e172a153817156d672bf2c325]
class ServerSentEventsBlueprint--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="ServerSentEventsBlueprint" style="stroke: #A80036; stroke-width: 1.5;" width="199" x="956.5" y="629"/><ellipse cx="971.5" cy="645" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M974.4688,650.6406 Q973.8906,650.9375 973.25,651.0781 Q972.6094,651.2344 971.9063,651.2344 Q969.4063,651.2344 968.0781,649.5938 Q966.7656,647.9375 966.7656,644.8125 Q966.7656,641.6875 968.0781,640.0313 Q969.4063,638.375 971.9063,638.375 Q972.6094,638.375 973.25,638.5313 Q973.9063,638.6875 974.4688,638.9844 L974.4688,641.7031 Q973.8438,641.125 973.25,640.8594 Q972.6563,640.5781 972.0313,640.5781 Q970.6875,640.5781 970,641.6563 Q969.3125,642.7188 969.3125,644.8125 Q969.3125,646.9063 970,647.9844 Q970.6875,649.0469 972.0313,649.0469 Q972.6563,649.0469 973.25,648.7813 Q973.8438,648.5 974.4688,647.9219 L974.4688,650.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="167" x="985.5" y="649.1543">ServerSentEventsBlueprint</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="957.5" x2="1154.5" y1="661" y2="661"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="957.5" x2="1154.5" y1="669" y2="669"/><!--MD5=[15ee56ae12769c5f2e72f0b218579190]
class ActivityService--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="73.6094" id="ActivityService" style="stroke: #A80036; stroke-width: 1.5;" width="302" x="410" y="437.5"/><ellipse cx="512.75" cy="453.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M515.7188,459.1406 Q515.1406,459.4375 514.5,459.5781 Q513.8594,459.7344 513.1563,459.7344 Q510.6563,459.7344 509.3281,458.0938 Q508.0156,456.4375 508.0156,453.3125 Q508.0156,450.1875 509.3281,448.5313 Q510.6563,446.875 513.1563,446.875 Q513.8594,446.875 514.5,447.0313 Q515.1563,447.1875 515.7188,447.4844 L515.7188,450.2031 Q515.0938,449.625 514.5,449.3594 Q513.9063,449.0781 513.2813,449.0781 Q511.9375,449.0781 511.25,450.1563 Q510.5625,451.2188 510.5625,453.3125 Q510.5625,455.4063 511.25,456.4844 Q511.9375,457.5469 513.2813,457.5469 Q513.9063,457.5469 514.5,457.2813 Q515.0938,457 515.7188,456.4219 L515.7188,459.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="533.25" y="457.6543">ActivityService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="411" x2="711" y1="469.5" y2="469.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="416" y="483.7104">history: List[ActivitySummary]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="411" x2="711" y1="490.3047" y2="490.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="290" x="416" y="504.5151">run(cmd: ActivityCommand) -&gt; ProcedureSummary</text><!--MD5=[f77b6e4f7e832f6279357a8e333fb5f3]
class ActivitySummary--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="137.6328" id="ActivitySummary" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="423.5" y="584"/><ellipse cx="506.75" cy="600" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M509.7188,605.6406 Q509.1406,605.9375 508.5,606.0781 Q507.8594,606.2344 507.1563,606.2344 Q504.6563,606.2344 503.3281,604.5938 Q502.0156,602.9375 502.0156,599.8125 Q502.0156,596.6875 503.3281,595.0313 Q504.6563,593.375 507.1563,593.375 Q507.8594,593.375 508.5,593.5313 Q509.1563,593.6875 509.7188,593.9844 L509.7188,596.7031 Q509.0938,596.125 508.5,595.8594 Q507.9063,595.5781 507.2813,595.5781 Q505.9375,595.5781 505.25,596.6563 Q504.5625,597.7188 504.5625,599.8125 Q504.5625,601.9063 505.25,602.9844 Q505.9375,604.0469 507.2813,604.0469 Q507.9063,604.0469 508.5,603.7813 Q509.0938,603.5 509.7188,602.9219 L509.7188,605.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="527.25" y="604.1543">ActivitySummary</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="424.5" x2="697.5" y1="616" y2="616"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="429.5" y="630.2104">id: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="429.5" y="643.0151">pid: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="429.5" y="655.8198">sbd_id: str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="429.5" y="668.6245">activity_name: str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="429.5" y="681.4292">prepare_only: bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="429.5" y="694.2339">arg_override: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="424.5" x2="697.5" y1="700.8281" y2="700.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="263" x="429.5" y="715.0386">activity_states: List[(ActivityState, timestamp)]</text><!--MD5=[7c8d4e4033842684f99cec4661c07e42]
class ActivityCommand--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="99.2188" id="ActivityCommand" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="251.5" y="603.5"/><ellipse cx="266.5" cy="619.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M269.4688,625.1406 Q268.8906,625.4375 268.25,625.5781 Q267.6094,625.7344 266.9063,625.7344 Q264.4063,625.7344 263.0781,624.0938 Q261.7656,622.4375 261.7656,619.3125 Q261.7656,616.1875 263.0781,614.5313 Q264.4063,612.875 266.9063,612.875 Q267.6094,612.875 268.25,613.0313 Q268.9063,613.1875 269.4688,613.4844 L269.4688,616.2031 Q268.8438,615.625 268.25,615.3594 Q267.6563,615.0781 267.0313,615.0781 Q265.6875,615.0781 265,616.1563 Q264.3125,617.2188 264.3125,619.3125 Q264.3125,621.4063 265,622.4844 Q265.6875,623.5469 267.0313,623.5469 Q267.6563,623.5469 268.25,623.2813 Q268.8438,623 269.4688,622.4219 L269.4688,625.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="280.5" y="623.6543">ActivityCommand</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="252.5" x2="387.5" y1="635.5" y2="635.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="257.5" y="649.7104">sbd_id: str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="257.5" y="662.5151">activity_name: str</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="257.5" y="675.3198">prepare_only: bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="257.5" y="688.1245">arg_override: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="252.5" x2="387.5" y1="694.7188" y2="694.7188"/><!--MD5=[92691f186a29e1f80a6717ce4cf4e4d2]
class ActivityState--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="60.8047" id="ActivityState" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="265.5" y="444"/><ellipse cx="280.5" cy="460" fill="#EB937F" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M284.6094,466 L276.8906,466 L276.8906,453.6094 L284.6094,453.6094 L284.6094,455.7656 L279.3438,455.7656 L279.3438,458.4375 L284.1094,458.4375 L284.1094,460.5938 L279.3438,460.5938 L279.3438,463.8438 L284.6094,463.8438 L284.6094,466 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="294.5" y="464.1543">ActivityState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="266.5" x2="373.5" y1="476" y2="476"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="271.5" y="490.2104">REQUESTED</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="266.5" x2="373.5" y1="496.8047" y2="496.8047"/><!--MD5=[6400ffe083689ac1542ec7825ea5fe0e]
class ProcedureSummary--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="99.2188" id="ProcedureSummary" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="38" y="425"/><ellipse cx="70.1" cy="441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M73.0688,446.6406 Q72.4906,446.9375 71.85,447.0781 Q71.2094,447.2344 70.5063,447.2344 Q68.0063,447.2344 66.6781,445.5938 Q65.3656,443.9375 65.3656,440.8125 Q65.3656,437.6875 66.6781,436.0313 Q68.0063,434.375 70.5063,434.375 Q71.2094,434.375 71.85,434.5313 Q72.5063,434.6875 73.0688,434.9844 L73.0688,437.7031 Q72.4438,437.125 71.85,436.8594 Q71.2563,436.5781 70.6313,436.5781 Q69.2875,436.5781 68.6,437.6563 Q67.9125,438.7188 67.9125,440.8125 Q67.9125,442.9063 68.6,443.9844 Q69.2875,445.0469 70.6313,445.0469 Q71.2563,445.0469 71.85,444.7813 Q72.4438,444.5 73.0688,443.9219 L73.0688,446.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="122" x="87.9" y="445.1543">ProcedureSummary</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="229" y1="457" y2="457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="44" y="471.2104">id: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="44" y="484.0151">script: domain.ExecutableScript</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="44" y="496.8198">script_args: ...</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="171" x="44" y="509.6245">state: domain.ProcedureState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="229" y1="516.2188" y2="516.2188"/><!--MD5=[56dc9bd079fa0794426dfac01e4747ad]
class Flask--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="Flask" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="1398" y="629"/><ellipse cx="1413" cy="645" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1415.9688,650.6406 Q1415.3906,650.9375 1414.75,651.0781 Q1414.1094,651.2344 1413.4063,651.2344 Q1410.9063,651.2344 1409.5781,649.5938 Q1408.2656,647.9375 1408.2656,644.8125 Q1408.2656,641.6875 1409.5781,640.0313 Q1410.9063,638.375 1413.4063,638.375 Q1414.1094,638.375 1414.75,638.5313 Q1415.4063,638.6875 1415.9688,638.9844 L1415.9688,641.7031 Q1415.3438,641.125 1414.75,640.8594 Q1414.1563,640.5781 1413.5313,640.5781 Q1412.1875,640.5781 1411.5,641.6563 Q1410.8125,642.7188 1410.8125,644.8125 Q1410.8125,646.9063 1411.5,647.9844 Q1412.1875,649.0469 1413.5313,649.0469 Q1414.1563,649.0469 1414.75,648.7813 Q1415.3438,648.5 1415.9688,647.9219 L1415.9688,650.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="1427" y="649.1543">Flask</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1399" x2="1461" y1="661" y2="661"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1399" x2="1461" y1="669" y2="669"/><!--MD5=[687b898a26107f91307f914974ba425d]
class Blueprint--><rect fill="#FEFECE" filter="url(#f1dp17vfn6wl5k)" height="48" id="Blueprint" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1398" y="782"/><ellipse cx="1413" cy="798" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1415.9688,803.6406 Q1415.3906,803.9375 1414.75,804.0781 Q1414.1094,804.2344 1413.4063,804.2344 Q1410.9063,804.2344 1409.5781,802.5938 Q1408.2656,800.9375 1408.2656,797.8125 Q1408.2656,794.6875 1409.5781,793.0313 Q1410.9063,791.375 1413.4063,791.375 Q1414.1094,791.375 1414.75,791.5313 Q1415.4063,791.6875 1415.9688,791.9844 L1415.9688,794.7031 Q1415.3438,794.125 1414.75,793.8594 Q1414.1563,793.5781 1413.5313,793.5781 Q1412.1875,793.5781 1411.5,794.6563 Q1410.8125,795.7188 1410.8125,797.8125 Q1410.8125,799.9063 1411.5,800.9844 Q1412.1875,802.0469 1413.5313,802.0469 Q1414.1563,802.0469 1414.75,801.7813 Q1415.3438,801.5 1415.9688,800.9219 L1415.9688,803.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="1427" y="802.1543">Blueprint</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1399" x2="1485" y1="814" y2="814"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1399" x2="1485" y1="822" y2="822"/><!--MD5=[41dc59b21b446ce9253699f860855aeb]
reverse link EventBusWorker to ActivityWorker--><path d="M752.8743,202.1164 C747.185,216.1815 741.3842,230.5224 736.4888,242.6248 " fill="none" id="EventBusWorker&lt;-ActivityWorker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="746.4789,199.2594,760.4677,183.3436,759.4573,204.5092,746.4789,199.2594" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[23aba4bc0d158aad32e01ce5d079dae1]
reverse link EventBusWorker to FlaskWorker--><path d="M820.5497,199.7936 C833.0253,217.325 845.9613,235.5035 855.865,249.4208 " fill="none" id="EventBusWorker&lt;-FlaskWorker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="814.7364,203.6975,808.8438,183.3436,826.143,195.5803,814.7364,203.6975" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[234f109516277ed6d8a92652e3d0a66a]
reverse link app to ProcedureAPIBlueprint--><path d="M1030.1419,507.5379 C1071.9696,528.3866 1126.2914,556.492 1173,584 C1196.7119,597.9646 1222.4924,615.0552 1242.4535,628.7334 " fill="none" id="app&lt;-ProcedureAPIBlueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1018.4164,501.7201,1022.0133,507.9701,1029.1659,507.0537,1025.569,500.8037,1018.4164,501.7201" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[062a945d08811656f7228f0c2a0c91d4]
reverse link app to ActivityAPIBlueprint--><path d="M937.0633,512.8725 C914.2182,548.0264 881.0973,598.9926 861.732,628.7918 " fill="none" id="app&lt;-ActivityAPIBlueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="944.3821,501.6103,937.7587,504.4617,937.8433,511.6723,944.4667,508.8209,944.3821,501.6103" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[71723dd1a6f45f6c1cc9bac83e5a3aed]
reverse link app to ServerSentEventsBlueprint--><path d="M982.4493,513.3319 C1000.9529,548.4692 1027.6273,599.1221 1043.2517,628.7918 " fill="none" id="app&lt;-ServerSentEventsBlueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="976.2766,501.6103,975.5331,508.783,981.868,512.228,982.6116,505.0553,976.2766,501.6103" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e4f2f32f24c45f71dd786268467d1361]
reverse link FlaskWorker to app--><path d="M886.6075,309.9407 C893.0947,326.8152 901.1413,347.0569 909,365 C921.4555,393.4386 937.0821,425.3224 948.1312,447.3178 " fill="none" id="FlaskWorker&lt;-app" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="881.9797,297.7869,880.3767,304.8176,886.2499,309.0014,887.853,301.9707,881.9797,297.7869" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[8999ddcf87d516ea4203eab1bea79430]
reverse link ActivityWorker to ActivityService--><path d="M691.0092,314.1819 C661.8275,350.1667 619.6018,402.2364 591.2696,437.1737 " fill="none" id="ActivityWorker&lt;-ActivityService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="699.2438,304.0276,692.3578,306.1683,691.6854,313.348,698.5714,311.2073,699.2438,304.0276" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[ba95c7f4237f35f52038bfc61d34fc99]
link Flask to Blueprint--><!--MD5=[7bc91e66d2a1940da7a755ed03b9f1fc]
link app to Flask--><path d="M1012.2449,501.5869 C1028.9731,509.7393 1047.9488,518.0818 1066,524 C1200.5947,568.1279 1259.1302,508.5398 1379,584 C1390.1172,590.9985 1399.6271,601.3633 1407.3178,611.9448 " fill="none" id="app-&gt;Flask" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1413.256,608.2371,1418.1888,628.8446,1401.4816,615.8111,1413.256,608.2371" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[f3d98311e43730daed2c83849b987c6c]
link ProcedureAPIBlueprint to Blueprint--><path d="M1303.1447,677.2433 C1329.4545,701.6396 1370.4115,739.6179 1401.0367,768.0158 " fill="none" id="ProcedureAPIBlueprint-&gt;Blueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1406.0718,763.1384,1415.9776,781.8701,1396.5526,773.4042,1406.0718,763.1384" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c874ef239efaf627a98fbfad0dd2f9af]
link ActivityAPIBlueprint to Blueprint--><path d="M865.0019,677.1069 C882.1007,696.9497 909.0807,724.0084 939,738 C1015.6349,773.8378 1260.2796,794.1702 1377.7938,802.0955 " fill="none" id="ActivityAPIBlueprint-&gt;Blueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1378.3559,795.1173,1397.8551,803.4108,1377.4399,809.0873,1378.3559,795.1173" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[ba85647e1184cfa2d18c00395cb919e8]
link ServerSentEventsBlueprint to Blueprint--><path d="M1083.2026,677.1877 C1105.9873,696.2652 1140.1349,722.207 1174,738 C1239.9647,768.7626 1321.8072,786.9395 1377.577,796.6477 " fill="none" id="ServerSentEventsBlueprint-&gt;Blueprint" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1379.0001,789.7879,1397.5873,799.9623,1376.7122,803.5997,1379.0001,789.7879" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[300e9285ec805b9a8d2729f84a85b227]
link main to application--><!--MD5=[605d9347a921b61a607f7c4a5e0cd06a]
link restserver to application--><!--MD5=[9e40e20377711443ecd082752ec33bb9]
link restserver to flask--><!--MD5=[b07931159a4624d0b61c6220108084ac]
link FlaskWorker to restserver--><!--MD5=[befbd7480b822880dc733844e1de8398]
link ActivityService to ActivitySummary--><!--MD5=[2f625559c56477e5fea0ad15a757ec27]
link ActivityCommand to ActivitySummary--><!--MD5=[7a6cfd1f1a38d059f94290ca394ec885]
@startuml

package ska_oso_oet.procedure {

package application as application_pkg {

    package main <<Rectangle>> {

        class ActivityWorker {
            run(...)
        }

        class FlaskWorker {
        }

        class EventBusWorker {
            main_loop(...)
            main_func(...)
            republish(...)
        }

        ActivityWorker -up-|> EventBusWorker
        FlaskWorker -up-|> EventBusWorker
    }

    package restserver <<Rectangle>> {
        class app <<function return value>> {
        }

        class ProcedureAPIBlueprint
        class ActivityAPIBlueprint
        class ServerSentEventsBlueprint

        app o- - ProcedureAPIBlueprint
        app o- - ActivityAPIBlueprint
        app o- - ServerSentEventsBlueprint
    }

    package application <<Rectangle>> {

        class ActivityService {
            history: List[ActivitySummary]

            run(cmd: ActivityCommand) -> ProcedureSummary
        }

        class ActivitySummary {
            id: int
            pid: int
            sbd_id: str
            activity_name: str
            prepare_only: bool
            arg_override: Dict
            activity_states: List[(ActivityState, timestamp)]
        }

        class ActivityCommand {
            sbd_id: str
            activity_name: str
            prepare_only: bool
            arg_override: Dict
        }

        enum ActivityState {
            REQUESTED
        }

        class ProcedureSummary {
            id: int
            script: domain.ExecutableScript
            script_args: ...
            state: domain.ProcedureState
        }
    }
}

FlaskWorker *- - app
ActivityWorker *- - ActivityService

package flask {
    class Flask
    class Blueprint

    Flask -down[hidden]- Blueprint
}

app -|> Flask
ProcedureAPIBlueprint -|> Blueprint
ActivityAPIBlueprint -|> Blueprint
ServerSentEventsBlueprint - -|> Blueprint

main -down[hidden]- -> application
restserver -left[hidden]- -> application
restserver -right[hidden]- -> flask
FlaskWorker -down[hidden]- -> restserver
ActivityService -down[hidden]- ActivitySummary
ActivitySummary -left[hidden]- ActivityCommand

@enduml

PlantUML version 1.2020.06(Sun Apr 05 12:38:32 GMT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14-ea+33
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>