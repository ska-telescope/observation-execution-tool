<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="843px" preserveAspectRatio="none" style="width:1050px;height:843px;background:#FFFFFF;" version="1.1" viewBox="0 0 1050 843" width="1050px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="832.3789" style="stroke:#000000;stroke-width:1.5;" width="1041" x="3.5" y="5"/><path d="M190.5,5 L190.5,14.4883 L180.5,24.4883 L3.5,24.4883 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="6.5" y="19.5352">seq:inter-process pubsub</text><rect height="342.9688" style="stroke:#000000;stroke-width:1.5;fill:none;" width="777" x="256" y="421.4336"/><rect height="113.8633" style="stroke:#000000;stroke-width:1.5;fill:none;" width="383" x="640" y="643.5391"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="154" x2="154" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="292" x2="292" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="433" x2="433" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="560" x2="560" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="686" x2="686" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="828" x2="828" y1="79.4648" y2="781.4023"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="969" x2="969" y1="79.4648" y2="781.4023"/><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="110" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="117" y="52.0234">pubsub A :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="120" y="68.5117">pypubsub</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="110" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="117" y="800.9375">pubsub A :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="120" y="817.4258">pypubsub</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="230" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="256.5" y="52.0234">Worker A :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="237" y="68.5117">EventBusWorker</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="230" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="256.5" y="800.9375">Worker A :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="237" y="817.4258">EventBusWorker</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="364" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="386.5" y="52.0234">Event Queue :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="371" y="68.5117">mptools.MPQueue</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="364" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="386.5" y="800.9375">Event Queue :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="371" y="817.4258">mptools.MPQueue</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="513" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="520" y="52.0234">main_loop :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="531.5" y="68.5117">function</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="513" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="520" y="800.9375">main_loop :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="531.5" y="817.4258">function</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="617" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="640.5" y="52.0234">Work Queue :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="624" y="68.5117">mptools.MPQueue</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="617" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="640.5" y="800.9375">Work Queue :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="624" y="817.4258">mptools.MPQueue</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="766" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="793.5" y="52.0234">Worker B :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="773" y="68.5117">EventBusWorker</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="766" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="793.5" y="800.9375">Worker B :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="773" y="817.4258">EventBusWorker</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="926" y="31.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="933" y="52.0234">pubsub B :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="935" y="68.5117">pypubsub</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="926" y="780.4023"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="933" y="800.9375">pubsub B :</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="935" y="817.4258">pypubsub</text><ellipse cx="12.5" cy="128.3359" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="142,125.0859,152,129.0859,142,133.0859,146,129.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="17" x2="148" y1="129.0859" y2="129.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="20" y="124.3438">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="33" y="124.3438">sendMessage(...)</text><path d="M159,94.4648 L159,149.4648 L392,149.4648 L392,104.4648 L382,94.4648 L159,94.4648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M382,94.4648 L382,104.4648 L392,104.4648 L382,94.4648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="165" y="112.0332">Code running in a worker process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="165" y="127.3438">publishes an event to the local</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="165" y="142.6543">pypubsub publish/subscribe bus.</text><polygon fill="#181818" points="280,213.9834,290,217.9834,280,221.9834,284,217.9834" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="286" y1="217.9834" y2="217.9834"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="161" y="213.2412">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="174" y="213.2412">republish(event)</text><path d="M297,160.3965 L297,261.3965 L562,261.3965 L562,170.3965 L552,160.3965 L297,160.3965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M552,160.3965 L552,170.3965 L562,170.3965 L552,160.3965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="112" x="303" y="177.6411">EventBusWorker</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="419" y="177.9648">is the common base</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="303" y="193.2754">class for OET worker processes. The</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="192" x="303" y="208.2622">EventBusWorker.republish</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="499" y="208.5859">method</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="303" y="223.8965">is subscribed to all pubsub events on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="303" y="239.207">all topics. As pubsub emits an event,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="303" y="254.5176">the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="327" y="254.1938">republish</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="403" y="254.5176">callback is called.</text><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="421.5" y1="314.5361" y2="310.5361"/><line style="stroke:#181818;stroke-width:1.0;" x1="431.5" x2="421.5" y1="314.5361" y2="318.5361"/><line style="stroke:#181818;stroke-width:1.0;" x1="292" x2="432.5" y1="314.5361" y2="314.5361"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="299" y="309.7939">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="312" y="309.7939">put(event)</text><path d="M438,272.2598 L438,343.2598 L704,343.2598 L704,282.2598 L694,272.2598 L438,272.2598 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M694,272.2598 L694,282.2598 L704,282.2598 L694,272.2598 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="444" y="289.8281">The</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="471" y="289.5044">republish</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="547" y="289.8281">callback method adds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="444" y="305.1387">the event to Event Queue, the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="633" y="304.8149">MPQueue</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="444" y="320.4492">monitored by the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="556" y="320.1255">main_loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="632" y="320.4492">function</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="444" y="335.7598">running in the main process.</text><polygon fill="#181818" points="444.5,384.123,434.5,388.123,444.5,392.123,440.5,388.123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="438.5" x2="559" y1="388.123" y2="388.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="450.5" y="383.3809">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="463.5" y="383.3809">safe_get()</text><path d="M179,353.502 L179,408.502 L428,408.502 L428,363.502 L418,353.502 L179,353.502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M418,353.502 L418,363.502 L428,363.502 L418,353.502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="185" y="371.0703">The</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="212" y="370.7466">main_loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="288" y="371.0703">function running in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="185" y="386.3809">the main process retrieves the event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="185" y="401.6914">from the Event Queue.</text><path d="M256,421.4336 L330,421.4336 L330,428.7441 L320,438.7441 L256,438.7441 L256,421.4336 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="342.9688" style="stroke:#000000;stroke-width:1.5;" width="777" x="256" y="421.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="271" y="435.002">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="192" x="345" y="434.0684">[each worker process work queue]</text><polygon fill="#181818" points="674.5,474.3652,684.5,478.3652,674.5,482.3652,678.5,478.3652" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="560" x2="680.5" y1="478.3652" y2="478.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="567" y="473.623">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="580" y="473.623">put(event)</text><path d="M266,443.7441 L266,498.7441 L555,498.7441 L555,453.7441 L545,443.7441 L266,443.7441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M545,443.7441 L545,453.7441 L555,453.7441 L545,443.7441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="272" y="460.9888">main_loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="348" y="461.3125">add the event onto the work</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="272" y="476.623">queue of each worker process managed by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="272" y="491.9336">the main process.</text><polygon fill="#181818" points="697.5,547.9521,687.5,551.9521,697.5,555.9521,693.5,551.9521" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="691.5" x2="827" y1="551.9521" y2="551.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="703.5" y="547.21">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="716.5" y="547.21">safe_get()</text><path d="M388,509.6758 L388,580.6758 L681,580.6758 L681,519.6758 L671,509.6758 L388,509.6758 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M671,509.6758 L671,519.6758 L681,519.6758 L671,509.6758 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="394" y="527.2441">The</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="192" x="421" y="526.9204">EventBusWorker.main_loop</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="617" y="527.2441">method</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="394" y="542.5547">loops over every event received on its work</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="394" y="557.8652">queue. It receives the event from the work</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="394" y="573.1758">queue.</text><polygon fill="#181818" points="957,613.8838,967,617.8838,957,621.8838,961,617.8838" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="828" x2="963" y1="617.8838" y2="617.8838"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="835" y="613.1416">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="848" y="613.1416">sendMessage(...)</text><path d="M557,590.918 L557,630.918 L823,630.918 L823,600.918 L813,590.918 L557,590.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M813,590.918 L813,600.918 L823,600.918 L813,590.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="563" y="608.4863">The event from the work queue is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="563" y="623.7969">republished as a local pypubsub event.</text><path d="M640,643.5391 L714,643.5391 L714,650.8496 L704,660.8496 L640,660.8496 L640,643.5391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="113.8633" style="stroke:#000000;stroke-width:1.5;" width="383" x="640" y="643.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="655" y="657.1074">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="177" x="729" y="656.1738">[each subscriber to event topic]</text><ellipse cx="1034.5" cy="715.0313" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1017.5,711.7813,1027.5,715.7813,1017.5,719.7813,1021.5,715.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="969" x2="1023.5" y1="715.7813" y2="715.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="976" y="711.0391">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="989" y="711.0391"> </text><path d="M650,665.8496 L650,751.8496 L964,751.8496 L964,675.8496 L954,665.8496 L650,665.8496 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M954,665.8496 L954,675.8496 L964,675.8496 L954,665.8496 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="656" y="683.418">pypubsub relays the event to all subscribers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="656" y="698.7285">of the event topic. This has the effect of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="656" y="714.0391">communicating the event that originated in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="656" y="729.3496">another Python process across Python process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="656" y="744.6602">boundaries.</text><!--MD5=[b782ce11d23a0a1dfb53784208d2d857]
@startuml
'https://plantuml.com/sequence-diagram


autonumber

mainframe seq:inter-process pubsub

participant "pubsub A :\npypubsub" as ps1 #lightblue
participant "Worker A :\nEventBusWorker" as ebw1 #lightblue
participant "Event Queue :\nmptools.MPQueue" as event_q #lightblue
participant "main_loop :\nfunction" as main_loop
participant "Work Queue :\nmptools.MPQueue" as work_q #lightgreen
participant "Worker B :\nEventBusWorker" as ebw2 #lightgreen
participant "pubsub B :\npypubsub" as ps2 #lightgreen

[o-> ps1: sendMessage(...)
note left
Code running in a worker process
publishes an event to the local
pypubsub publish/subscribe bus.
end note

ps1 -> ebw1: republish(event)
note right
""EventBusWorker"" is the common base
class for OET worker processes. The
""EventBusWorker.republish"" method
is subscribed to all pubsub events on
all topics. As pubsub emits an event,
the ""republish"" callback is called.
end note


ebw1 ->> event_q: put(event)
note right
The ""republish"" callback method adds
the event to Event Queue, the ""MPQueue""
monitored by the ""main_loop"" function
running in the main process.
end note


event_q <- main_loop: safe_get()
note left
The ""main_loop"" function running in
the main process retrieves the event
from the Event Queue.
end note

loop each worker process work queue

main_loop -> work_q: put(event)
note left
""main_loop"" add the event onto the work
queue of each worker process managed by
the main process.
end note


ebw2 -> work_q: safe_get()
note left
The ""EventBusWorker.main_loop"" method
loops over every event received on its work
queue. It receives the event from the work
queue.
end note

ebw2 -> ps2: sendMessage(...)
note left
The event from the work queue is
republished as a local pypubsub event.
end note

loop each subscriber to event topic
ps2 ->o]
note left
pypubsub relays the event to all subscribers
of the event topic. This has the effect of
communicating the event that originated in
another Python process across Python process
boundaries.
end note
end

end

@enduml

@startuml


autonumber

mainframe seq:inter-process pubsub

participant "pubsub A :\npypubsub" as ps1 #lightblue
participant "Worker A :\nEventBusWorker" as ebw1 #lightblue
participant "Event Queue :\nmptools.MPQueue" as event_q #lightblue
participant "main_loop :\nfunction" as main_loop
participant "Work Queue :\nmptools.MPQueue" as work_q #lightgreen
participant "Worker B :\nEventBusWorker" as ebw2 #lightgreen
participant "pubsub B :\npypubsub" as ps2 #lightgreen

[o-> ps1: sendMessage(...)
note left
Code running in a worker process
publishes an event to the local
pypubsub publish/subscribe bus.
end note

ps1 -> ebw1: republish(event)
note right
""EventBusWorker"" is the common base
class for OET worker processes. The
""EventBusWorker.republish"" method
is subscribed to all pubsub events on
all topics. As pubsub emits an event,
the ""republish"" callback is called.
end note


ebw1 ->> event_q: put(event)
note right
The ""republish"" callback method adds
the event to Event Queue, the ""MPQueue""
monitored by the ""main_loop"" function
running in the main process.
end note


event_q <- main_loop: safe_get()
note left
The ""main_loop"" function running in
the main process retrieves the event
from the Event Queue.
end note

loop each worker process work queue

main_loop -> work_q: put(event)
note left
""main_loop"" add the event onto the work
queue of each worker process managed by
the main process.
end note


ebw2 -> work_q: safe_get()
note left
The ""EventBusWorker.main_loop"" method
loops over every event received on its work
queue. It receives the event from the work
queue.
end note

ebw2 -> ps2: sendMessage(...)
note left
The event from the work queue is
republished as a local pypubsub event.
end note

loop each subscriber to event topic
ps2 ->o]
note left
pypubsub relays the event to all subscribers
of the event topic. This has the effect of
communicating the event that originated in
another Python process across Python process
boundaries.
end note
end

end

@enduml

PlantUML version 1.2022.5(Sat Apr 30 11:55:52 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>